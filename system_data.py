import wmi
import os
import sys
from time import sleep

# We are going to check if the system is a windows System. If not exit...
if os.name != "nt":
    print "Run this on a windows Environment."
    sys.exit(0)

management = wmi.WMI()

def NetworkInfo():
    try:
    # In this section of the code we get the network information using the given system
        print "+" * 23
        print "Network Information"
        print "+" * 23
        print ""
        for netParams in management.Win32_NetworkAdapterConfiguration():

            if netParams.MACAddress != None and netParams.IPAddress != None  and netParams.IPSubnet != None:

                # if there is an existing Domain
                if netParams.DNSDomain != None:
                    print "Domain: ", netParams.DNSDomain

                print "Mac: " + netParams.MACAddress.lower()
                print "IP: " + netParams.IPAddress[0]
                print "Mask " + netParams.IPSubnet[0]
    except Exception as e:
        print e

def SystemInfo():

    try:
        print ""
        print "+" * 30
        print "System profile Information"
        print "+" * 30
        print ""
        for profileParams in management.Win32_NetworkLoginProfile():
            if profileParams.Name != None:
                print "Profile: " + profileParams.Name
    except Exception as e:
        print e

# We have the OS Information as name, Architecture, and the name of the user
def OperatingSysInfo():
    try:
        print ""
        print "+" * 30
        print "Operating System Information."
        print "+" * 30
        print ""
        for SOParams in management.Win32_operatingSystem():
            print "Operating System name: " + SOParams.caption
            print "Computer Name: " + SOParams.CSName
            print "Architecture: " + SOParams.OSArchitecture
            print "User Registered: " + SOParams.RegisteredUser.upper()

    except Exception as e:
        print e

# We have information about the partitions as Disk (Physical, Logical, USB) etc..
def Partitions():

   #while True: Remove the hash tag sign if you want to monitor in real time. Don't forget to make necessary indentations
    try:
        for disk in management.Win32_DiskDrive():
            for partitions in disk.associators("Win32_DiskDriveToDiskPartition"):
                for logical_unit in partitions.associators("Win32_LogicalDiskToPartition"):
                    print "Logical Disk: " + logical_unit.Caption
                    print "Volume Name: " + logical_unit.VolumeName
                    print "File System Type: " + logical_unit.FileSystem
                    print "Size (GB): ", int(logical_unit.Size) / 1073741824
                    print "Free Space (GB): ", int(logical_unit.FreeSpace) / 1073741824

                    print "\n"
        sleep(10)
    except  Exception as e:
        print e

def main():

    print "-" * 30  
    print "INFORMATION GATHERING SCRIPT"
    print "-" * 30

    print "There is a mine of gold this computer has to offer you."
    print "\n"
    try:
        NetworkInfo()
        SystemInfo()
        OperatingSysInfo()
        Partitions()
    except Exception as e:
        print e


if __name__ == "__main__":
    main()
